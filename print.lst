


ARM Macro Assembler    Page 1 


    1 00000000         ; Print.s
    2 00000000         ; Student names: change this to your names or look very 
                       silly
    3 00000000         ; Last modification date: change this to the last modifi
                       cation date or look very silly
    4 00000000         ; Runs on LM4F120 or TM4C123
    5 00000000         ; EE319K lab 7 device driver for any LCD
    6 00000000         ;
    7 00000000         ; As part of Lab 7, students need to implement these LCD
                       _OutDec and LCD_OutFix
    8 00000000         ; This driver assumes two low-level LCD functions
    9 00000000         ; ST7735_OutChar   outputs a single 8-bit ASCII characte
                       r
   10 00000000         ; ST7735_OutString outputs a null-terminated string 
   11 00000000 00000002 
                       VAR     EQU              2           ;this is number of 
                                                            local variables
   12 00000000 00000000 
                       DIV     EQU              0
   13 00000000 00000004 
                       Lead    EQU              4
   14 00000000         
   15 00000000                 IMPORT           ST7735_OutChar
   16 00000000                 IMPORT           ST7735_OutString
   17 00000000                 EXPORT           LCD_OutDec
   18 00000000                 EXPORT           LCD_OutFix
   19 00000000         
   20 00000000                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   21 00000000                 THUMB
   22 00000000         
   23 00000000         
   24 00000000         
   25 00000000         ;-----------------------LCD_OutDec----------------------
                       -
   26 00000000         ; Output a 32-bit number in unsigned decimal format
   27 00000000         ; Input: R0 (call by value) 32-bit unsigned number
   28 00000000         ; Output: none
   29 00000000         ; Invariables: This function must not permanently modify
                        registers R4 to R11
   30 00000000         LCD_OutDec
   31 00000000 B51F            PUSH             {R0,R1,R2,R3,R4,LR}
   32 00000002 2800            CMP              R0, #0
   33 00000004 D04A            BEQ              PrintZero
   34 00000006 F04F 0100       MOV              R1, #0
   35 0000000A F04F 0200       MOV              R2, #0
   36 0000000E B082            SUB              SP, #8
   37 00000010         ;PUSH {R1,R2}   ;allocation
   38 00000010 46EB            MOV              R11, SP     ;now R11 has locati
                                                            on of where local v
                                                            ariables are
   39 00000012 F242 7110       MOV              R1, #10000
   40 00000016 F04F 020A       MOV              R2, #10
   41 0000001A FB01 F101       MUL              R1, R1, R1
   42 0000001E FB01 F102       MUL              R1, R1, R2
   43 00000022 F8CB 1000       STR              R1, [R11, #DIV]
   44 00000026 F04F 0300       MOV              R3, #0
   45 0000002A F8CB 3004       STR              R3, [R11, #Lead]
   46 0000002E         ODLoop



ARM Macro Assembler    Page 2 


   47 0000002E F8DB 1000       LDR              R1, [R11, #DIV]
   48 00000032 2900            CMP              R1, #0
   49 00000034 D02D            BEQ              LastCase
   50 00000036 4603            MOV              R3, R0
   51 00000038 FBB3 F3F1       UDIV             R3, R1
   52 0000003C FB01 F403       MUL              R4, R1, R3
   53 00000040 EBA0 0004       SUB              R0, R4
   54 00000044 E92D 081F       PUSH             {R0,R1,R2,R3,R4,R11}
   55 00000048 4618            MOV              R0, R3
   56 0000004A 2800            CMP              R0, #0
   57 0000004C D014            BEQ              CheckZero
   58 0000004E F8DB 1004       LDR              R1, [R11, #Lead]
   59 00000052 F101 0101       ADD              R1, #1
   60 00000056 F8CB 1004       STR              R1, [R11, #Lead]
   61 0000005A F100 0030       ADD              R0, #0X30
   62 0000005E F7FF FFFE       BL               ST7735_OutChar
   63 00000062         ODRest
   64 00000062 E8BD 081F       POP              {R0,R1,R2,R3,R4,R11}
   65 00000066 F8DB 1000       LDR              R1, [R11, #DIV]
   66 0000006A F04F 020A       MOV              R2, #10
   67 0000006E FBB1 F1F2       UDIV             R1, R2
   68 00000072 F8CB 1000       STR              R1, [R11, #DIV]
   69 00000076 E7DA            B                ODLoop
   70 00000078         
   71 00000078         CheckZero
   72 00000078 F8DB 1004       LDR              R1, [R11, #Lead]
   73 0000007C 2900            CMP              R1, #0
   74 0000007E D0F0            BEQ              ODRest
   75 00000080 E92D 0801       PUSH             {R0,R11}
   76 00000084 F04F 0030       MOV              R0, #0X30
   77 00000088 F7FF FFFE       BL               ST7735_OutChar
   78 0000008C E8BD 0801       POP              {R0,R11}
   79 00000090 E7E7            B                ODRest
   80 00000092         
   81 00000092         
   82 00000092         LastCase
   83 00000092 E8BD 4001       POP              {R0,LR}
   84 00000096 E8BD 401F       POP              {R0,R1,R2,R3,R4,LR}
   85 0000009A 4770            BX               LR
   86 0000009C         
   87 0000009C         PrintZero
   88 0000009C E92D 0801       PUSH             {R0,R11}
   89 000000A0 F04F 0030       MOV              R0, #0X30
   90 000000A4 F7FF FFFE       BL               ST7735_OutChar
   91 000000A8 E8BD 0801       POP              {R0, R11}
   92 000000AC E8BD 401F       POP              {R0,R1,R2,R3,R4,LR}
   93 000000B0 4770            BX               LR
   94 000000B2         ;* * * * * * * * End of LCD_OutDec * * * * * * * *
   95 000000B2         
   96 000000B2         ; -----------------------LCD _OutFix--------------------
                       --
   97 000000B2         ; Output characters to LCD display in fixed-point format
                       
   98 000000B2         ; unsigned decimal, resolution 0.001, range 0.000 to 9.9
                       99
   99 000000B2         ; Inputs:  R0 is an unsigned 32-bit number
  100 000000B2         ; Outputs: none
  101 000000B2         ; E.g., R0=0,    then output "0.000 "
  102 000000B2         ;       R0=3,    then output "0.003 "



ARM Macro Assembler    Page 3 


  103 000000B2         ;       R0=89,   then output "0.089 "
  104 000000B2         ;       R0=123,  then output "0.123 "
  105 000000B2         ;       R0=9999, then output "9.999 "
  106 000000B2         ;       R0>9999, then output "*.*** "
  107 000000B2         ; Invariables: This function must not permanently modify
                        registers R4 to R11
  108 000000B2         LCD_OutFix
  109 000000B2 E92D 480F       PUSH             {R0-R3,R11,LR}
  110 000000B6 F04F 0100       MOV              R1, #0
  111 000000BA F04F 0200       MOV              R2, #0
  112 000000BE B406            PUSH             {R1,R2}     ;allocation
  113 000000C0 46EB            MOV              R11, SP     ;now R11 has locati
                                                            on of where local v
                                                            ariables are
  114 000000C2 F242 7110       MOV              R1, #10000
  115 000000C6 F8CB 1000       STR              R1, [R11, #DIV]
  116 000000CA F8DB 1000       LDR              R1, [R11, #DIV]
  117 000000CE 4288            CMP              R0, R1
  118 000000D0 D22C            BHS              TooBig
  119 000000D2         
  120 000000D2 F000 F812       BL               OutDig      ;ones place
  121 000000D6         
  122 000000D6 E92D 480F       PUSH             {R0-R3,R11,LR}
  123 000000DA F04F 002E       MOV              R0, #0X2E   ;decimal
  124 000000DE F7FF FFFE       BL               ST7735_OutChar
  125 000000E2 E8BD 480F       POP              {R0-R3,R11,LR}
  126 000000E6         
  127 000000E6 F000 F808       BL               OutDig      ;tenths place
  128 000000EA         
  129 000000EA F000 F806       BL               OutDig      ;hundredths place
  130 000000EE         
  131 000000EE F000 F804       BL               OutDig      ;thousandths place
  132 000000F2         
  133 000000F2         rest
  134 000000F2 BC06            POP              {R1,R2}
  135 000000F4 E8BD 480F       POP              {R0-R3,R11,LR}
  136 000000F8 4770            BX               LR
  137 000000FA         
  138 000000FA         OutDig
  139 000000FA F04F 020A       MOV              R2, #10
  140 000000FE FBB1 F1F2       UDIV             R1, R2
  141 00000102 F8CB 1000       STR              R1, [R11, #DIV]
  142 00000106 F8DB 1000       LDR              R1, [R11, #DIV]
  143 0000010A 4602            MOV              R2, R0
  144 0000010C FBB2 F2F1       UDIV             R2, R1
  145 00000110 FB01 F302       MUL              R3, R1, R2
  146 00000114 EBA0 0003       SUB              R0, R3
  147 00000118 E92D 480F       PUSH             {R0-R3,R11,LR}
  148 0000011C 4610            MOV              R0, R2
  149 0000011E F100 0030       ADD              R0, #0X30
  150 00000122 F7FF FFFE       BL               ST7735_OutChar
  151 00000126 E8BD 480F       POP              {R0-R3,R11,LR}
  152 0000012A 4770            BX               LR
  153 0000012C         
  154 0000012C         TooBig
  155 0000012C F04F 002A       MOV              R0, #0X2A   ;*
  156 00000130 F7FF FFFE       BL               ST7735_OutChar
  157 00000134 F04F 002E       MOV              R0, #0X2E   ;.
  158 00000138 F7FF FFFE       BL               ST7735_OutChar



ARM Macro Assembler    Page 4 


  159 0000013C F04F 002A       MOV              R0, #0X2A   ;*
  160 00000140 F7FF FFFE       BL               ST7735_OutChar
  161 00000144 F04F 002A       MOV              R0, #0X2A   ;*
  162 00000148 F7FF FFFE       BL               ST7735_OutChar
  163 0000014C F04F 002A       MOV              R0, #0X2A   ;*
  164 00000150 F7FF FFFE       BL               ST7735_OutChar
  165 00000154 E7CD            B                rest
  166 00000156         ;* * * * * * * * End of LCD_OutFix * * * * * * * *
  167 00000156         
  168 00000156 00 00           ALIGN                        ; make sure the end
                                                             of this section is
                                                             aligned
  169 00000158                 END                          ; end of file
Command Line: --debug --xref --cpu=Cortex-M4 --apcs=interwork --depend=.\print.
d -o.\print.o -ID:\wei\Documents\ee319k\keil\ARM\RV31\INC -ID:\wei\Documents\ee
319k\keil\ARM\CMSIS\Include -ID:\wei\Documents\ee319k\keil\ARM\Inc\Luminary --p
redefine="__EVAL SETA 1" --list=.\print.lst Print.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 20 in file Print.s
   Uses
      None
Comment: .text unused
CheckZero 00000078

Symbol: CheckZero
   Definitions
      At line 71 in file Print.s
   Uses
      At line 57 in file Print.s
Comment: CheckZero used once
LCD_OutDec 00000000

Symbol: LCD_OutDec
   Definitions
      At line 30 in file Print.s
   Uses
      At line 17 in file Print.s
Comment: LCD_OutDec used once
LCD_OutFix 000000B2

Symbol: LCD_OutFix
   Definitions
      At line 108 in file Print.s
   Uses
      At line 18 in file Print.s
Comment: LCD_OutFix used once
LastCase 00000092

Symbol: LastCase
   Definitions
      At line 82 in file Print.s
   Uses
      At line 49 in file Print.s
Comment: LastCase used once
ODLoop 0000002E

Symbol: ODLoop
   Definitions
      At line 46 in file Print.s
   Uses
      At line 69 in file Print.s
Comment: ODLoop used once
ODRest 00000062

Symbol: ODRest
   Definitions
      At line 63 in file Print.s
   Uses
      At line 74 in file Print.s
      At line 79 in file Print.s

OutDig 000000FA




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: OutDig
   Definitions
      At line 138 in file Print.s
   Uses
      At line 120 in file Print.s
      At line 127 in file Print.s
      At line 129 in file Print.s
      At line 131 in file Print.s

PrintZero 0000009C

Symbol: PrintZero
   Definitions
      At line 87 in file Print.s
   Uses
      At line 33 in file Print.s
Comment: PrintZero used once
TooBig 0000012C

Symbol: TooBig
   Definitions
      At line 154 in file Print.s
   Uses
      At line 118 in file Print.s
Comment: TooBig used once
rest 000000F2

Symbol: rest
   Definitions
      At line 133 in file Print.s
   Uses
      At line 165 in file Print.s
Comment: rest used once
11 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

DIV 00000000

Symbol: DIV
   Definitions
      At line 12 in file Print.s
   Uses
      At line 43 in file Print.s
      At line 47 in file Print.s
      At line 65 in file Print.s
      At line 68 in file Print.s
      At line 115 in file Print.s
      At line 116 in file Print.s
      At line 141 in file Print.s
      At line 142 in file Print.s

Lead 00000004

Symbol: Lead
   Definitions
      At line 13 in file Print.s
   Uses
      At line 45 in file Print.s
      At line 58 in file Print.s
      At line 60 in file Print.s
      At line 72 in file Print.s

VAR 00000002

Symbol: VAR
   Definitions
      At line 11 in file Print.s
   Uses
      None
Comment: VAR unused
3 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

ST7735_OutChar 00000000

Symbol: ST7735_OutChar
   Definitions
      At line 15 in file Print.s
   Uses
      At line 62 in file Print.s
      At line 77 in file Print.s
      At line 90 in file Print.s
      At line 124 in file Print.s
      At line 150 in file Print.s
      At line 156 in file Print.s
      At line 158 in file Print.s
      At line 160 in file Print.s
      At line 162 in file Print.s
      At line 164 in file Print.s

ST7735_OutString 00000000

Symbol: ST7735_OutString
   Definitions
      At line 16 in file Print.s
   Uses
      None
Comment: ST7735_OutString unused
2 symbols
347 symbols in table
